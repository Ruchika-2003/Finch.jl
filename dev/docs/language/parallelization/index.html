<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Parallelization · Finch.jl</title><meta name="title" content="Parallelization · Finch.jl"/><meta property="og:title" content="Parallelization · Finch.jl"/><meta property="twitter:title" content="Parallelization · Finch.jl"/><meta name="description" content="Documentation for Finch.jl."/><meta property="og:description" content="Documentation for Finch.jl."/><meta property="twitter:description" content="Documentation for Finch.jl."/><meta property="og:url" content="https://finch-tensor.github.io/Finch.jl/docs/language/parallelization/"/><meta property="twitter:url" content="https://finch-tensor.github.io/Finch.jl/docs/language/parallelization/"/><link rel="canonical" href="https://finch-tensor.github.io/Finch.jl/docs/language/parallelization/"/><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../search_index.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script><link href="../../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../../"><img src="../../../assets/logo.png" alt="Finch.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../../">Finch.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../../">Home</a></li><li><a class="tocitem" href="../../../getting_started/">Getting Started</a></li><li><span class="tocitem">Documentation</span><ul><li><a class="tocitem" href="../../tensor_formats/">Tensor Formats</a></li><li><a class="tocitem" href="../../array_api/">High-Level Array API</a></li><li><a class="tocitem" href="../../sparse_utils/">Sparse and Structured Utilities</a></li><li><a class="tocitem" href="../../user-defined_functions/">User-Defined Functions</a></li><li><a class="tocitem" href="../../fileio/">FileIO</a></li><li><input class="collapse-toggle" id="menuitem-3-6" type="checkbox" checked/><label class="tocitem" for="menuitem-3-6"><span class="docs-label">Advanced: Finch Language</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../calling_finch/">Calling Finch</a></li><li><a class="tocitem" href="../finch_language/">The Finch Language</a></li><li><a class="tocitem" href="../dimensionalization/">Dimensionalization</a></li><li><a class="tocitem" href="../index_sugar/">Index Sugar</a></li><li><a class="tocitem" href="../mask_sugar/">Mask Sugar</a></li><li><a class="tocitem" href="../iteration_protocols/">Iteration Protocols</a></li><li class="is-active"><a class="tocitem" href>Parallelization</a><ul class="internal"><li><a class="tocitem" href="#Formats"><span>Formats</span></a></li><li><a class="tocitem" href="#Parallel-Loops"><span>Parallel Loops</span></a></li></ul></li><li><a class="tocitem" href="../interoperability/">Interoperability</a></li><li><a class="tocitem" href="../optimization_tips/">Optimization Tips</a></li><li><a class="tocitem" href="../benchmarking_tips/">Benchmarking Tips</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-7" type="checkbox"/><label class="tocitem" for="menuitem-3-7"><span class="docs-label">Developers: Internal Details</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../internals/virtualization/">Virtualization</a></li><li><a class="tocitem" href="../../internals/tensor_interface/">Tensor Interface</a></li><li><a class="tocitem" href="../../internals/compiler_interface/">Compiler Interfaces</a></li><li><a class="tocitem" href="../../internals/finch_notation/">Finch Notation</a></li><li><a class="tocitem" href="../../internals/finch_logic/">Finch Logic</a></li></ul></li></ul></li><li><a class="tocitem" href="../../../CONTRIBUTING/">Community and Contributions</a></li><li><span class="tocitem">Appendices and Additional Resources</span><ul><li><a class="tocitem" href="../../../appendices/directory_structure/">Directory Structure</a></li><li><a class="tocitem" href="../../../appendices/directory_structure/">Code Listing</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Documentation</a></li><li><a class="is-disabled">Advanced: Finch Language</a></li><li class="is-active"><a href>Parallelization</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Parallelization</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/finch-tensor/Finch.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/finch-tensor/Finch.jl/blob/main/docs/src/docs/language/parallelization.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="(Experimental)-Parallelization-in-Finch"><a class="docs-heading-anchor" href="#(Experimental)-Parallelization-in-Finch">(Experimental) Parallelization in Finch</a><a id="(Experimental)-Parallelization-in-Finch-1"></a><a class="docs-heading-anchor-permalink" href="#(Experimental)-Parallelization-in-Finch" title="Permalink"></a></h1><h2 id="Formats"><a class="docs-heading-anchor" href="#Formats">Formats</a><a id="Formats-1"></a><a class="docs-heading-anchor-permalink" href="#Formats" title="Permalink"></a></h2><p>Finch levels usually cannot be updated concurrently from multiple threads. Sparse and structured formats typically store their data buffers contiguously across different columns, making parallel updates difficult to implement correctly and efficiently. However, Finch provides a few specialized concurrent level types, and a few levels which can reinterpret other level formats in a concurrent way.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.AtomicElementLevel" href="#Finch.AtomicElementLevel"><code>Finch.AtomicElementLevel</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">AtomicElementLevel{Vf, [Tv=typeof(Vf)], [Tp=Int], [Val]}()</code></pre><p>Like an <a href="../../tensor_formats/#Finch.ElementLevel"><code>ElementLevel</code></a>, but updates to the level are performed atomically.</p><pre><code class="language-julia-repl hljs">julia&gt; tensor_tree(Tensor(Dense(AtomicElement(0.0)), [1, 2, 3]))
3-Tensor
└─ Dense [1:3]
   ├─ [1]: 1.0
   ├─ [2]: 2.0
   └─ [3]: 3.0</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/finch-tensor/Finch.jl/blob/1421710983abd61784145111ba2220d88c598423/src/tensors/levels/atomic_element_levels.jl#L1-L14">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.MutexLevel" href="#Finch.MutexLevel"><code>Finch.MutexLevel</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">MutexLevel{Val, Lvl}()</code></pre><p>Mutex Level Protects the level directly below it with atomics</p><p>Each position in the level below the Mutex level is protected by a lock.</p><pre><code class="language-julia-repl hljs">julia&gt; tensor_tree(Tensor(Dense(Mutex(Element(0.0))), [1, 2, 3]))
3-Tensor
└─ Dense [1:3]
   ├─ [1]: Mutex -&gt;
   │  └─ 1.0
   ├─ [2]: Mutex -&gt;
   │  └─ 2.0
   └─ [3]: Mutex -&gt;
      └─ 3.0</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/finch-tensor/Finch.jl/blob/1421710983abd61784145111ba2220d88c598423/src/tensors/levels/mutex_levels.jl#L1-L18">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.SeparateLevel" href="#Finch.SeparateLevel"><code>Finch.SeparateLevel</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">SeparateLevel{Lvl, [Val]}()</code></pre><p>A subfiber of a Separate level is a separate tensor of type <code>Lvl</code>, in it&#39;s own memory space.</p><p>Each sublevel is stored in a vector of type <code>Val</code> with <code>eltype(Val) = Lvl</code>.</p><pre><code class="language-julia-repl hljs">julia&gt; tensor_tree(Tensor(Dense(Separate(Element(0.0))), [1, 2, 3]))
3-Tensor
└─ Dense [1:3]
   ├─ [1]: Pointer -&gt;
   │  └─ 1.0
   ├─ [2]: Pointer -&gt;
   │  └─ 2.0
   └─ [3]: Pointer -&gt;
      └─ 3.0</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/finch-tensor/Finch.jl/blob/1421710983abd61784145111ba2220d88c598423/src/tensors/levels/separate_levels.jl#L1-L20">source</a></section></article><h2 id="Parallel-Loops"><a class="docs-heading-anchor" href="#Parallel-Loops">Parallel Loops</a><a id="Parallel-Loops-1"></a><a class="docs-heading-anchor-permalink" href="#Parallel-Loops" title="Permalink"></a></h2><p>A loop can be run in parallel with a <code>parallel</code> dimension. A dimension can be wrapped in the <code>parallel()</code> modifier to indicate that it should run in parallel.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.parallel" href="#Finch.parallel"><code>Finch.parallel</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">parallel(ext, device=CPU(nthreads()), schedule=static_schedule())</code></pre><p>A dimension <code>ext</code> that is parallelized over <code>device</code> using the <code>schedule</code>. The <code>ext</code> field is usually <code>_</code>, or dimensionless, but can be any standard dimension argument.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/finch-tensor/Finch.jl/blob/1421710983abd61784145111ba2220d88c598423/src/dimensions.jl#L237-L242">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.CPU" href="#Finch.CPU"><code>Finch.CPU</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">CPU(n)</code></pre><p>A device that represents a CPU with n threads.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/finch-tensor/Finch.jl/blob/1421710983abd61784145111ba2220d88c598423/src/architecture.jl#L124-L128">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.Serial" href="#Finch.Serial"><code>Finch.Serial</code></a> — <span class="docstring-category">Type</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">Serial()</code></pre><p>A device that represents a serial CPU execution.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/finch-tensor/Finch.jl/blob/1421710983abd61784145111ba2220d88c598423/src/architecture.jl#L92-L96">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../iteration_protocols/">« Iteration Protocols</a><a class="docs-footer-nextpage" href="../interoperability/">Interoperability »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Wednesday 23 July 2025 16:49">Wednesday 23 July 2025</span>. Using Julia version 1.11.6.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
