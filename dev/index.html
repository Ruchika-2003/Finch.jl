<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Home · Finch.jl</title><meta name="title" content="Home · Finch.jl"/><meta property="og:title" content="Home · Finch.jl"/><meta property="twitter:title" content="Home · Finch.jl"/><meta name="description" content="Documentation for Finch.jl."/><meta property="og:description" content="Documentation for Finch.jl."/><meta property="twitter:description" content="Documentation for Finch.jl."/><meta property="og:url" content="https://finch-tensor.github.io/Finch.jl/"/><meta property="twitter:url" content="https://finch-tensor.github.io/Finch.jl/"/><link rel="canonical" href="https://finch-tensor.github.io/Finch.jl/"/><script data-outdated-warner src="assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="search_index.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script><link href="assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href><img src="assets/logo.png" alt="Finch.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href>Finch.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li class="is-active"><a class="tocitem" href>Home</a><ul class="internal"><li><a class="tocitem" href="#Why-Finch.jl?"><span>Why Finch.jl?</span></a></li><li class="toplevel"><a class="tocitem" href="#Installation"><span>Installation</span></a></li><li><a class="tocitem" href="#Quickstart"><span>Quickstart</span></a></li><li><a class="tocitem" href="#Learn-More"><span>Learn More</span></a></li><li><a class="tocitem" href="#Beyond-Finch"><span>Beyond Finch</span></a></li><li><a class="tocitem" href="#Contributing"><span>Contributing</span></a></li></ul></li><li><a class="tocitem" href="getting_started/">Getting Started</a></li><li><span class="tocitem">Documentation</span><ul><li><a class="tocitem" href="docs/tensor_formats/">Tensor Formats</a></li><li><a class="tocitem" href="docs/array_api/">High-Level Array API</a></li><li><a class="tocitem" href="docs/sparse_utils/">Sparse and Structured Utilities</a></li><li><a class="tocitem" href="docs/user-defined_functions/">User-Defined Functions</a></li><li><a class="tocitem" href="docs/fileio/">FileIO</a></li><li><input class="collapse-toggle" id="menuitem-3-6" type="checkbox"/><label class="tocitem" for="menuitem-3-6"><span class="docs-label">Advanced: Finch Language</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="docs/language/calling_finch/">Calling Finch</a></li><li><a class="tocitem" href="docs/language/finch_language/">The Finch Language</a></li><li><a class="tocitem" href="docs/language/dimensionalization/">Dimensionalization</a></li><li><a class="tocitem" href="docs/language/index_sugar/">Index Sugar</a></li><li><a class="tocitem" href="docs/language/mask_sugar/">Mask Sugar</a></li><li><a class="tocitem" href="docs/language/iteration_protocols/">Iteration Protocols</a></li><li><a class="tocitem" href="docs/language/parallelization/">Parallelization</a></li><li><a class="tocitem" href="docs/language/interoperability/">Interoperability</a></li><li><a class="tocitem" href="docs/language/optimization_tips/">Optimization Tips</a></li><li><a class="tocitem" href="docs/language/benchmarking_tips/">Benchmarking Tips</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-7" type="checkbox"/><label class="tocitem" for="menuitem-3-7"><span class="docs-label">Developers: Internal Details</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="docs/internals/virtualization/">Virtualization</a></li><li><a class="tocitem" href="docs/internals/tensor_interface/">Tensor Interface</a></li><li><a class="tocitem" href="docs/internals/compiler_interface/">Compiler Interfaces</a></li><li><a class="tocitem" href="docs/internals/finch_notation/">Finch Notation</a></li><li><a class="tocitem" href="docs/internals/finch_logic/">Finch Logic</a></li></ul></li></ul></li><li><a class="tocitem" href="CONTRIBUTING/">Community and Contributions</a></li><li><span class="tocitem">Appendices and Additional Resources</span><ul><li><a class="tocitem" href="appendices/directory_structure/">Directory Structure</a></li><li><a class="tocitem" href="appendices/directory_structure/">Code Listing</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Home</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Home</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/finch-tensor/Finch.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/finch-tensor/Finch.jl/blob/main/docs/src/index.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Finch.jl"><a class="docs-heading-anchor" href="#Finch.jl">Finch.jl</a><a id="Finch.jl-1"></a><a class="docs-heading-anchor-permalink" href="#Finch.jl" title="Permalink"></a></h1><p>Finch is a Julia-to-Julia compiler for sparse or structured multidimensional arrays. Finch empowers users to write high-level array programs which are transformed behind-the-scenes into fast sparse code.</p><h2 id="Why-Finch.jl?"><a class="docs-heading-anchor" href="#Why-Finch.jl?">Why Finch.jl?</a><a id="Why-Finch.jl?-1"></a><a class="docs-heading-anchor-permalink" href="#Why-Finch.jl?" title="Permalink"></a></h2><p>Finch was built to make sparse and structured array programming easier and more efficient.  Finch.jl leverages compiler technology to automatically generate customized, fused sparse kernels for each specific use case. This allows users to write readable, high-level sparse array programs without worrying about the performance of the generated code. Finch can automatically generate efficient implementations even for unique problems that lack existing library solutions.</p><h1 id="Installation"><a class="docs-heading-anchor" href="#Installation">Installation</a><a id="Installation-1"></a><a class="docs-heading-anchor-permalink" href="#Installation" title="Permalink"></a></h1><p>At the <a href="https://julialang.org/downloads/">Julia</a> REPL, install the latest stable version by running:</p><pre><code class="language-julia hljs">julia&gt; using Pkg;
       Pkg.add(&quot;Finch&quot;);
</code></pre><h2 id="Quickstart"><a class="docs-heading-anchor" href="#Quickstart">Quickstart</a><a id="Quickstart-1"></a><a class="docs-heading-anchor-permalink" href="#Quickstart" title="Permalink"></a></h2><pre><code class="language-julia hljs">julia&gt; using Finch

# Create a sparse tensor

julia&gt; A = Tensor(CSCFormat(), [1 0 0; 0 2 0; 0 0 3])
3×3 Tensor{DenseLevel{Int64, SparseListLevel{Int64, Vector{Int64}, Vector{Int64}, ElementLevel{0.0, Float64, Int64, Vector{Float64}}}}}:
 1.0  0.0  0.0
 0.0  2.0  0.0
 0.0  0.0  3.0

# Perform a simple operation

julia&gt; B = A + A
3×3 Tensor{DenseLevel{Int64, SparseDictLevel{Int64, Vector{Int64}, Vector{Int64}, Vector{Int64}, Dict{Tuple{Int64, Int64}, Int64}, Vector{Int64}, ElementLevel{0.0, Float64, Int64, Vector{Float64}}}}}:
 2.0  0.0  0.0
 0.0  4.0  0.0
 0.0  0.0  6.0</code></pre><h3 id="Sparse-and-Structured-Tensors"><a class="docs-heading-anchor" href="#Sparse-and-Structured-Tensors">Sparse and Structured Tensors</a><a id="Sparse-and-Structured-Tensors-1"></a><a class="docs-heading-anchor-permalink" href="#Sparse-and-Structured-Tensors" title="Permalink"></a></h3><p>Finch supports most major sparse formats (CSR, CSC, DCSR, DCSC, CSF, COO, Hash, Bytemap). Finch also allows users to define their own sparse formats with a parameterized format language.</p><pre><code class="nohighlight hljs">CSC_matrix = Tensor(CSCFormat())
CSR_matrix = swizzle(Tensor(CSCFormat()), 2, 1)
CSF_tensor = Tensor(CSFFormat(3))</code></pre><p>Finch also supports a wide variety of array structure beyond sparsity. Whether you&#39;re dealing with <a href="https://en.wikipedia.org/wiki/GraphBLAS">custom background (zero) values</a>, <a href="https://en.wikipedia.org/wiki/Run-length_encoding">run-length encoding</a>, or matrices with <a href="https://en.wikipedia.org/wiki/Sparse_matrix#Special_structure">special structures</a> like banded or triangular matrices, Finch’s compiler can understand and optimize various data patterns and computational rules to adapt to the structure of data.</p><h3 id="Examples:"><a class="docs-heading-anchor" href="#Examples:">Examples:</a><a id="Examples:-1"></a><a class="docs-heading-anchor-permalink" href="#Examples:" title="Permalink"></a></h3><p>Finch supports many high-level array operations out of the box, such as <code>+</code>, <code>*</code>, <code>maximum</code>, <code>sum</code>, <code>map</code>, <code>broadcast</code>, and <code>reduce</code>.</p><pre><code class="language-julia hljs">julia&gt; using Finch

# Define sparse tensor A

julia&gt; A = Tensor(Dense(SparseList(Element(0.0))), [0 1.1 0; 2.2 0 3.3; 4.4 0 0; 0 0 5.5])

# Define sparse tensor B

julia&gt; B = Tensor(Dense(SparseList(Element(0.0))), [0 1 1; 1 0 0; 0 0 1; 0 0 1])

# Element-wise multiplication

julia&gt; C = A .* B

# Element-wise max

julia&gt; C = max.(A, B)

# Sum over rows

julia&gt; D = sum(C; dims=2)
</code></pre><p>For situations where more complex operations are needed, Finch supports an <code>@einsum</code> syntax on sparse and structured tensors.</p><pre><code class="language-julia hljs">julia&gt; @einsum E[i] += A[i, j] * B[i, j]

julia&gt; @einsum F[i, k] &lt;&lt; max &gt;&gt;= A[i, j] + B[k, j]
</code></pre><p>Finch even allows users to fuse multiple operations into a single kernel with <code>lazy</code> and <code>compute</code>.  The <code>lazy</code> function creates a lazy tensor, which is a symbolic representation of the computation. The <code>compute</code> function evaluates the computation. Different optimizers can be used with <code>compute</code>, such as the state-of-the-art <code>Galley</code> optimizer, which can adapt to the sparsity patterns of the inputs.</p><pre><code class="language-julia hljs">julia&gt; using Finch, BenchmarkTools

julia&gt; A = fsprand(1000, 1000, 0.1);
       B = fsprand(1000, 1000, 0.1);
       C = fsprand(1000, 1000, 0.0001);

julia&gt; A = lazy(A);
       B = lazy(B);
       C = lazy(C);

julia&gt; sum(A * B * C)

julia&gt; @btime compute(sum(A * B * C));
  263.612 ms (1012 allocations: 185.08 MiB)

julia&gt; @btime compute(sum(A * B * C), ctx=galley_scheduler());
  153.708 μs (667 allocations: 29.02 KiB)</code></pre><h3 id="How-it-Works"><a class="docs-heading-anchor" href="#How-it-Works">How it Works</a><a id="How-it-Works-1"></a><a class="docs-heading-anchor-permalink" href="#How-it-Works" title="Permalink"></a></h3><p>Finch first translates high-level array code into <strong>FinchLogic</strong>, a custom intermediate representation that captures operator fusion and enables loop ordering optimizations. Using advanced schedulers, Finch optimizes FinchLogic and lowers it to <strong>FinchNotation</strong>, a more refined representation that precisely defines control flow. This optimized FinchNotation is then compiled into highly efficient, sparsity-aware code. Finch can specialize to each combination of sparse formats and algebraic properties, such as <code>x * 0 =&gt; 0</code>, eliminating unnecessary computations in sparse code automatically.</p><h2 id="Learn-More"><a class="docs-heading-anchor" href="#Learn-More">Learn More</a><a id="Learn-More-1"></a><a class="docs-heading-anchor-permalink" href="#Learn-More" title="Permalink"></a></h2><p>The following manuscripts provide a good description of the research behind Finch:</p><p><a href="https://arxiv.org/abs/2404.16730">Finch: Sparse and Structured Array Programming with Control Flow</a>. Willow Ahrens, Teodoro Fields Collin, Radha Patel, Kyle Deeds, Changwan Hong, Saman Amarasinghe.</p><p><a href="https://doi.org/10.1145/3579990.3580020">Looplets: A Language for Structured Coiteration</a>. CGO 2023. Willow Ahrens, Daniel Donenfeld, Fredrik Kjolstad, Saman Amarasinghe.</p><h2 id="Beyond-Finch"><a class="docs-heading-anchor" href="#Beyond-Finch">Beyond Finch</a><a id="Beyond-Finch-1"></a><a class="docs-heading-anchor-permalink" href="#Beyond-Finch" title="Permalink"></a></h2><p>The following research efforts use Finch:</p><p><a href="https://arxiv.org/abs/2406.09266">SySTeC: A Symmetric Sparse Tensor Compiler</a>. Radha Patel, Willow Ahrens, Saman Amarasinghe.</p><p><a href="https://arxiv.org/abs/2407.01742">The Continuous Tensor Abstraction: Where Indices are Real</a>. Jaeyeon Won, Willow Ahrens, Joel S. Emer, Saman Amarasinghe.</p><p><a href="https://arxiv.org/abs/2408.14706">Galley: Modern Query Optimization for Sparse Tensor Programs</a>. Kyle Deeds, Willow Ahrens, Magda Balazinska, Dan Suciu.</p><h2 id="Contributing"><a class="docs-heading-anchor" href="#Contributing">Contributing</a><a id="Contributing-1"></a><a class="docs-heading-anchor-permalink" href="#Contributing" title="Permalink"></a></h2><p>Contributions are welcome! Please see our <a href="CONTRIBUTING/">contribution guidelines</a> for more information.</p></article><nav class="docs-footer"><a class="docs-footer-nextpage" href="getting_started/">Getting Started »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.14.1 on <span class="colophon-date" title="Wednesday 23 July 2025 16:49">Wednesday 23 July 2025</span>. Using Julia version 1.11.6.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
