<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>The Finch Language · Finch.jl</title><meta name="title" content="The Finch Language · Finch.jl"/><meta property="og:title" content="The Finch Language · Finch.jl"/><meta property="twitter:title" content="The Finch Language · Finch.jl"/><meta name="description" content="Documentation for Finch.jl."/><meta property="og:description" content="Documentation for Finch.jl."/><meta property="twitter:description" content="Documentation for Finch.jl."/><meta property="og:url" content="https://finch-tensor.github.io/Finch.jl/docs/language/finch_language/"/><meta property="twitter:url" content="https://finch-tensor.github.io/Finch.jl/docs/language/finch_language/"/><link rel="canonical" href="https://finch-tensor.github.io/Finch.jl/docs/language/finch_language/"/><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../search_index.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script><link href="../../../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../../"><img src="../../../assets/logo.png" alt="Finch.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../../">Finch.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../../">Home</a></li><li><a class="tocitem" href="../../../getting_started/">Getting Started</a></li><li><span class="tocitem">Documentation</span><ul><li><a class="tocitem" href="../../tensor_formats/">Tensor Formats</a></li><li><a class="tocitem" href="../../array_api/">High-Level Array API</a></li><li><a class="tocitem" href="../../sparse_utils/">Sparse and Structured Utilities</a></li><li><a class="tocitem" href="../../user-defined_functions/">User-Defined Functions</a></li><li><a class="tocitem" href="../../fileio/">FileIO</a></li><li><input class="collapse-toggle" id="menuitem-3-6" type="checkbox" checked/><label class="tocitem" for="menuitem-3-6"><span class="docs-label">Advanced: Finch Language</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../calling_finch/">Calling Finch</a></li><li class="is-active"><a class="tocitem" href>The Finch Language</a><ul class="internal"><li><a class="tocitem" href="#Finch-Notation"><span>Finch Notation</span></a></li><li class="toplevel"><a class="tocitem" href="#Scoping"><span>Scoping</span></a></li><li class="toplevel"><a class="tocitem" href="#Tensor-Lifecycle"><span>Tensor Lifecycle</span></a></li><li class="toplevel"><a class="tocitem" href="#Dimensionalization"><span>Dimensionalization</span></a></li><li class="toplevel"><a class="tocitem" href="#Array-Combinators"><span>Array Combinators</span></a></li><li class="toplevel"><a class="tocitem" href="#Fancy-Indexing"><span>Fancy Indexing</span></a></li></ul></li><li><a class="tocitem" href="../dimensionalization/">Dimensionalization</a></li><li><a class="tocitem" href="../index_sugar/">Index Sugar</a></li><li><a class="tocitem" href="../mask_sugar/">Mask Sugar</a></li><li><a class="tocitem" href="../iteration_protocols/">Iteration Protocols</a></li><li><a class="tocitem" href="../parallelization/">Parallelization</a></li><li><a class="tocitem" href="../interoperability/">Interoperability</a></li><li><a class="tocitem" href="../optimization_tips/">Optimization Tips</a></li><li><a class="tocitem" href="../benchmarking_tips/">Benchmarking Tips</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3-7" type="checkbox"/><label class="tocitem" for="menuitem-3-7"><span class="docs-label">Developers: Internal Details</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../internals/virtualization/">Virtualization</a></li><li><a class="tocitem" href="../../internals/tensor_interface/">Tensor Interface</a></li><li><a class="tocitem" href="../../internals/compiler_interface/">Compiler Interfaces</a></li><li><a class="tocitem" href="../../internals/finch_notation/">Finch Notation</a></li><li><a class="tocitem" href="../../internals/finch_logic/">Finch Logic</a></li></ul></li></ul></li><li><a class="tocitem" href="../../../CONTRIBUTING/">Community and Contributions</a></li><li><span class="tocitem">Appendices and Additional Resources</span><ul><li><a class="tocitem" href="../../../appendices/directory_structure/">Directory Structure</a></li><li><a class="tocitem" href="../../../appendices/directory_structure/">Code Listing</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Documentation</a></li><li><a class="is-disabled">Advanced: Finch Language</a></li><li class="is-active"><a href>The Finch Language</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>The Finch Language</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/finch-tensor/Finch.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/finch-tensor/Finch.jl/blob/main/docs/src/docs/language/finch_language.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h2 id="Finch-Notation"><a class="docs-heading-anchor" href="#Finch-Notation">Finch Notation</a><a id="Finch-Notation-1"></a><a class="docs-heading-anchor-permalink" href="#Finch-Notation" title="Permalink"></a></h2><p>Finch programs are written in Julia, but they are not Julia programs. Instead, they are an abstraction description of a tensor computation.</p><p>Several examples are given in the <a href="https://github.com/finch-tensor/Finch.jl/blob/main/docs/examples">examples directory</a>.</p><p>Finch programs are blocks of tensor operations, joined by control flow. Finch is an imperative language. The AST is separated into statements and expressions, where statements can modify the state of the program but expressions cannot.</p><p>The core Finch expressions are:</p><ul><li><a href="#Finch.FinchNotation.literal"><code>literal</code></a> e.g. <code>1</code>, <code>1.0</code>, <code>nothing</code></li><li><a href="#Finch.FinchNotation.value"><code>value</code></a> e.g. <code>x</code>, <code>y</code></li><li><a href="#Finch.FinchNotation.index"><code>index</code></a> e.g. <code>i</code>, inside of <code>for i = _; ... end</code></li><li><a href="#Finch.FinchNotation.variable"><code>variable</code></a> e.g. <code>x</code>, inside of <code>(x = y; ...)</code></li><li><a href="#Finch.FinchNotation.call"><code>call</code></a> e.g. <code>op(args...)</code></li><li><a href="#Finch.FinchNotation.access"><code>access</code></a> e.g. <code>tns[idxs...]</code></li></ul><p>And the core Finch statements are:</p><ul><li><a href="#Finch.FinchNotation.declare"><code>declare</code></a> e.g. <code>tns .= init</code></li><li><a href="#Finch.FinchNotation.assign"><code>assign</code></a> e.g. <code>lhs[idxs...] &lt;&lt;op&gt;&gt;= rhs</code></li><li><a href="#Finch.FinchNotation.loop"><code>loop</code></a> e.g. <code>for i = _; ... end</code></li><li><a href="#Finch.FinchNotation.define"><code>define</code></a> e.g. <code>let var = val; ... end</code></li><li><a href="#Finch.FinchNotation.sieve"><code>sieve</code></a> e.g. <code>if cond; ... end</code></li><li><a href="#Finch.FinchNotation.block"><code>block</code></a> e.g. <code>begin ... end</code></li></ul><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.FinchNotation.literal" href="#Finch.FinchNotation.literal"><code>Finch.FinchNotation.literal</code></a> — <span class="docstring-category">Constant</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">literal(val)</code></pre><p>Finch AST expression for the literal value <code>val</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/finch-tensor/Finch.jl/blob/96f167694e4ae3c9a7365511a3287654e62575f8/src/FinchNotation/nodes.jl#L33-L37">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.FinchNotation.value" href="#Finch.FinchNotation.value"><code>Finch.FinchNotation.value</code></a> — <span class="docstring-category">Constant</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">value(val, type)</code></pre><p>Finch AST expression for host code <code>val</code> expected to evaluate to a value of type <code>type</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/finch-tensor/Finch.jl/blob/96f167694e4ae3c9a7365511a3287654e62575f8/src/FinchNotation/nodes.jl#L40-L45">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.FinchNotation.index" href="#Finch.FinchNotation.index"><code>Finch.FinchNotation.index</code></a> — <span class="docstring-category">Constant</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">index(name)</code></pre><p>Finch AST expression for an index named <code>name</code>. Each index must be quantified by a corresponding <code>loop</code> which iterates over all values of the index.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/finch-tensor/Finch.jl/blob/96f167694e4ae3c9a7365511a3287654e62575f8/src/FinchNotation/nodes.jl#L48-L53">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.FinchNotation.variable" href="#Finch.FinchNotation.variable"><code>Finch.FinchNotation.variable</code></a> — <span class="docstring-category">Constant</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">variable(name)</code></pre><p>Finch AST expression for a variable named <code>name</code>. The variable can be looked up in the context.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/finch-tensor/Finch.jl/blob/96f167694e4ae3c9a7365511a3287654e62575f8/src/FinchNotation/nodes.jl#L56-L61">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.FinchNotation.call" href="#Finch.FinchNotation.call"><code>Finch.FinchNotation.call</code></a> — <span class="docstring-category">Constant</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">call(op, args...)</code></pre><p>Finch AST expression for the result of calling the function <code>op</code> on <code>args...</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/finch-tensor/Finch.jl/blob/96f167694e4ae3c9a7365511a3287654e62575f8/src/FinchNotation/nodes.jl#L84-L88">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.FinchNotation.access" href="#Finch.FinchNotation.access"><code>Finch.FinchNotation.access</code></a> — <span class="docstring-category">Constant</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">access(tns, mode, idx...)</code></pre><p>Finch AST expression representing the value of tensor <code>tns</code> at the indices <code>idx...</code>. The <code>mode</code> differentiates between reads or updates and whether the access is in-place.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/finch-tensor/Finch.jl/blob/96f167694e4ae3c9a7365511a3287654e62575f8/src/FinchNotation/nodes.jl#L91-L97">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.FinchNotation.define" href="#Finch.FinchNotation.define"><code>Finch.FinchNotation.define</code></a> — <span class="docstring-category">Constant</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">define(lhs, rhs, body)</code></pre><p>Finch AST statement that defines <code>lhs</code> as having the value <code>rhs</code> in <code>body</code>. A new scope is introduced to evaluate <code>body</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/finch-tensor/Finch.jl/blob/96f167694e4ae3c9a7365511a3287654e62575f8/src/FinchNotation/nodes.jl#L132-L137">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.FinchNotation.assign" href="#Finch.FinchNotation.assign"><code>Finch.FinchNotation.assign</code></a> — <span class="docstring-category">Constant</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">assign(lhs, op, rhs)</code></pre><p>Finch AST statement that updates the value of <code>lhs</code> to <code>op(lhs, rhs)</code>. Overwriting is accomplished with the function <code>overwrite(lhs, rhs) = rhs</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/finch-tensor/Finch.jl/blob/96f167694e4ae3c9a7365511a3287654e62575f8/src/FinchNotation/nodes.jl#L124-L129">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.FinchNotation.loop" href="#Finch.FinchNotation.loop"><code>Finch.FinchNotation.loop</code></a> — <span class="docstring-category">Constant</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">loop(idx, ext, body)</code></pre><p>Finch AST statement that runs <code>body</code> for each value of <code>idx</code> in <code>ext</code>. Tensors in <code>body</code> must have ranges that agree with <code>ext</code>. A new scope is introduced to evaluate <code>body</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/finch-tensor/Finch.jl/blob/96f167694e4ae3c9a7365511a3287654e62575f8/src/FinchNotation/nodes.jl#L107-L113">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.FinchNotation.sieve" href="#Finch.FinchNotation.sieve"><code>Finch.FinchNotation.sieve</code></a> — <span class="docstring-category">Constant</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">sieve(cond, body)</code></pre><p>Finch AST statement that only executes <code>body</code> if <code>cond</code> is true. A new scope is introduced to evaluate <code>body</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/finch-tensor/Finch.jl/blob/96f167694e4ae3c9a7365511a3287654e62575f8/src/FinchNotation/nodes.jl#L116-L121">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.FinchNotation.block" href="#Finch.FinchNotation.block"><code>Finch.FinchNotation.block</code></a> — <span class="docstring-category">Constant</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">block(bodies...)</code></pre><p>Finch AST statement that executes each of it&#39;s arguments in turn.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/finch-tensor/Finch.jl/blob/96f167694e4ae3c9a7365511a3287654e62575f8/src/FinchNotation/nodes.jl#L161-L165">source</a></section></article><h1 id="Scoping"><a class="docs-heading-anchor" href="#Scoping">Scoping</a><a id="Scoping-1"></a><a class="docs-heading-anchor-permalink" href="#Scoping" title="Permalink"></a></h1><p>Finch programs are scoped. Scopes contain variable definitions and tensor declarations.  Loops and sieves introduce new scopes. The following program has four scopes, each of which is numbered to the left of the statements it contains.</p><pre><code class="nohighlight hljs">@finch begin
1   y .= 0
1   for j = _
1   2   t .= 0
1   2   for i = _
1   2   3   t[] += A[i, j] * x[i]
1   2   end
1   2   for i = _
1   2   4   y[i] += A[i, j] * t[]
1   2   end
1   end
end</code></pre><p>Variables refer to their defined values in the innermost containing scope. If variables are undefined, they are assumed to have global scope (they may come from the surrounding program).</p><h1 id="Tensor-Lifecycle"><a class="docs-heading-anchor" href="#Tensor-Lifecycle">Tensor Lifecycle</a><a id="Tensor-Lifecycle-1"></a><a class="docs-heading-anchor-permalink" href="#Tensor-Lifecycle" title="Permalink"></a></h1><p>Tensors have two modes: Read and Update. Tensors in read mode may be read, but not updated. Tensors in update mode may be updated, but not read. A tensor declaration initializes and possibly resizes the tensor, setting it to update mode. Also, Finch will automatically change the mode of tensors as they are used. However, tensors may only change their mode within scopes that contain their declaration. If a tensor has not been declared, it is assumed to have global scope.</p><p>Tensor declaration is different than variable definition. Declaring a tensor initializes the memory (usually to zero) and sets the tensor to update mode. Defining a tensor simply gives a name to that memory. A tensor may be declared multiple times, but it may only be defined once.</p><p>Tensors are assumed to be in read mode when they are defined. Tensors must enter and exit scope in read mode. Finch inserts <code>freeze</code> and <code>thaw</code> statements to ensure that tensors are in the correct mode. Freezing a tensor prevents further updates and allows reads. Thawing a tensor allows further updates and prevents reads.</p><p>Tensor lifecycle statements consist of:</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.FinchNotation.declare" href="#Finch.FinchNotation.declare"><code>Finch.FinchNotation.declare</code></a> — <span class="docstring-category">Constant</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">declare(tns, init)</code></pre><p>Finch AST statement that declares <code>tns</code> with an initial value <code>init</code> in the current scope.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/finch-tensor/Finch.jl/blob/96f167694e4ae3c9a7365511a3287654e62575f8/src/FinchNotation/nodes.jl#L140-L144">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.FinchNotation.freeze" href="#Finch.FinchNotation.freeze"><code>Finch.FinchNotation.freeze</code></a> — <span class="docstring-category">Constant</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">freeze(tns)</code></pre><p>Finch AST statement that freezes <code>tns</code> in the current scope.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/finch-tensor/Finch.jl/blob/96f167694e4ae3c9a7365511a3287654e62575f8/src/FinchNotation/nodes.jl#L147-L151">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="Finch.FinchNotation.thaw" href="#Finch.FinchNotation.thaw"><code>Finch.FinchNotation.thaw</code></a> — <span class="docstring-category">Constant</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">thaw(tns)</code></pre><p>Finch AST statement that thaws <code>tns</code> in the current scope.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/finch-tensor/Finch.jl/blob/96f167694e4ae3c9a7365511a3287654e62575f8/src/FinchNotation/nodes.jl#L154-L158">source</a></section></article><h1 id="Dimensionalization"><a class="docs-heading-anchor" href="#Dimensionalization">Dimensionalization</a><a id="Dimensionalization-1"></a><a class="docs-heading-anchor-permalink" href="#Dimensionalization" title="Permalink"></a></h1><p>Finch loops have dimensions. Accessing a tensor with an unmodified loop index &quot;hints&quot; that the loop should have the same dimension as the corresponding axis of the tensor. Finch will automatically dimensionalize loops that are hinted by tensor accesses. One may refer to the automatically determined dimension using a variable named <code>_</code> or <code>:</code>.</p><p>Similarly, tensor declarations also set the dimensions of a tensor. Accessing a tensor with an unmodified loop index &quot;hints&quot; that the tensor axis should have the same dimension as the corresponding loop. Finch will automatically dimensionalize declarations based on all updates up to the first read.</p><h1 id="Array-Combinators"><a class="docs-heading-anchor" href="#Array-Combinators">Array Combinators</a><a id="Array-Combinators-1"></a><a class="docs-heading-anchor-permalink" href="#Array-Combinators" title="Permalink"></a></h1><p>Finch includes several array combinators that modify the behavior of arrays. For example, the <code>OffsetArray</code> type wraps an existing array, but shifts its indices. The <code>PermissiveArray</code> type wraps an existing array, but allows out-of-bounds reads and writes. When an array is accessed out of bounds, it produces <code>Missing</code>.</p><p>Array combinators introduce some complexity to the tensor lifecycle, as wrappers may contain multiple or different arrays that could potentially be in different modes. Any array combinators used in a tensor access must reference a single global variable which holds the root array. The root array is the single array that gets declared, and changes modes from read to update, or vice versa.</p><h1 id="Fancy-Indexing"><a class="docs-heading-anchor" href="#Fancy-Indexing">Fancy Indexing</a><a id="Fancy-Indexing-1"></a><a class="docs-heading-anchor-permalink" href="#Fancy-Indexing" title="Permalink"></a></h1><p>Finch supports arbitrary indexing of arrays, but certain indexing operations have first class support through array combinators. Before dimensionalization, the following transformations are performed:</p><pre><code class="nohighlight hljs">    A[i + c] =&gt;        OffsetArray(A, c)[i]
    A[i + j] =&gt;      ToeplitzArray(A, 1)[i, j]
       A[~i] =&gt; PermissiveArray(A, true)[i]</code></pre><p>Note that these transformations may change the behavior of dimensionalization, since they often result in unmodified loop indices (the index <code>i</code> will participate in dimensionalization, but an index expression like <code>i + 1</code> will not).</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../calling_finch/">« Calling Finch</a><a class="docs-footer-nextpage" href="../dimensionalization/">Dimensionalization »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.8.0 on <span class="colophon-date" title="Wednesday 27 November 2024 03:12">Wednesday 27 November 2024</span>. Using Julia version 1.11.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
